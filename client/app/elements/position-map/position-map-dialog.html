<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animations.html">
<!-- https://elements.polymer-project.org/elements/paper-dialog -->


<dom-module id="position-map-dialog">
  <template>
    <paper-dialog id="positionDialog" entry-animation="fade-in-animation" exit-animation="fade-out-animation" modal>
      <h2>{{title}}</h2>
      <template is="dom-if" if="{{!post}}">
        <paper-dialog-scrollable>
          Multi posts... Brendan's lazy.
        </paper-dialog-scrollable>
        <div class="buttons">
          <paper-button dialog-dismiss>Neat</paper-button>
        </div>
      </template>
      <template is="dom-if" if="{{post}}">
        <paper-dialog-scrollable>
          Single post... Brendan's lazy.
        </paper-dialog-scrollable>
        <div class="buttons">
          <paper-button dialog-dismiss>Neat</paper-button>
        </div>
      </template>
    </paper-dialog>
  </template>
</dom-module>
<script>
  Polymer({
    is: 'position-map-dialog',
    properties: {
      point: {
        type: Object,  // city, state, country, post, photos...
        observer: '_updateStatics',
      },
      post: Object,
      title: {
        type: String,
        computed: '_getTitle(point, post)'
      }
    },
    openDialog: function() {
      console.log('opening dialog!');
      if (this.point && this.point.posts && this.point.posts.length == 1) {
        this.post = this.point.posts[0]
      } else {
        this.post = null;
      }
      this.$.positionDialog.open();
    },
    closeDialog: function() {
      this.post = null;
      this.$.positionDialog.close();
    },
    isMultiPost: function() {
      return this.point && this.point.posts && this.point.posts.length > 1;
    },
    _getTitle: function() {
      if (this.post) {
        return this.post.title;
      } else if (this.point) {
        return this.point.title;
      }
      return 'Untitled';
    },
    _updateStatics: function() {
      this.title = '';
      if (this.point) {
        if (this.point.city) {
          this.title = this.point.city + ', ' + this.point.country;
        } else {
          this.title = 'Somewhere in ' + this.point.country;
        }
      }
    },
    displayPost: function(post) {

    },
  });
</script>
